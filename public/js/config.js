/* author: carl, date: Thu Feb 09 2012 13:44:29 GMT+0800 (CST) */Ext.require(["Ext.form.*","Ext.data.*"]);
Ext.onReady(function(){function c(){if(!("object"!==typeof CONFIG_OBJ||null===CONFIG_OBJ)){var b=CONFIG_OBJ,a;for(a in b)if(Object.prototype.hasOwnProperty.call(b,a))"compress"===a?(Ext.select("input[name=jscmd]").first().dom.value=b[a].js,Ext.select("input[name=csscmd]").first().dom.value=b[a].css):Ext.select("input[name="+a+"]").first().dom.value=b[a]}}Ext.create("Ext.form.Panel",{renderTo:"configContainer",frame:!0,title:"构建工具配置",width:800,bodyPadding:5,style:"margin:20px auto;",waitMsgTarget:!0,
fieldDefaults:{labelAlign:"right",labelWidth:105,msgTarget:"side"},items:[{xtype:"fieldcontainer",fieldLabel:"base",layout:"hbox",items:[{xtype:"textfield",value:"/home/zmm/work/",name:"base",hideLabel:!0,width:228,allowBlank:!1},{xtype:"splitter"},{xtype:"label",text:"基础工作目录，所有的分支都存于此目录中",flex:1}]},{xtype:"fieldcontainer",fieldLabel:"binPath",layout:"hbox",items:[{xtype:"textfield",value:"./",name:"binPath",hideLabel:!0,width:228,allowBlank:!1},{xtype:"splitter"},{xtype:"label",text:"相对于每个分支根目录的构建完成后的文件目录，即线上使用的文件",
flex:1}]},{xtype:"fieldcontainer",fieldLabel:"srcPath",layout:"hbox",items:[{xtype:"textfield",value:"src/",name:"srcPath",hideLabel:!0,width:228,allowBlank:!1},{xtype:"splitter"},{xtype:"label",text:"相对于每个分支根目录的源文件目录",flex:1}]},{xtype:"fieldcontainer",fieldLabel:"updatePaths",layout:"hbox",items:[{xtype:"textfield",value:"{base}/zone;{base}/cooperation",name:"updatePaths",hideLabel:!0,width:228,allowBlank:!1},{xtype:"splitter"},{xtype:"label",text:"需要更新引用文件版本号的目录",flex:1}]},{xtype:"fieldset",title:"Compress",
items:[{xtype:"label",text:"编译工具的命令，css使用yuicompressor，js使用google的.",width:320,margin:"0 0 0 90",flex:1},{xtype:"textfield",value:"java -jar {toolPath}/yuicompressor-2.4.6.jar {srcPath} --type css --charset utf-8 -o {binPath}",name:"csscmd",fieldLabel:"css",width:650,allowBlank:!1},{xtype:"textfield",value:"java -jar {toolPath}/compiler.jar --warning_level QUIET --js {srcPath} --js_output_file {binPath}",name:"jscmd",width:650,fieldLabel:"js",allowBlank:!1}]},{xtype:"fieldcontainer",fieldLabel:"js",
layout:"hbox",items:[{xtype:"textfield",value:"js/",name:"js",hideLabel:!0,width:228,allowBlank:!1},{xtype:"splitter"},{xtype:"label",text:"相对于源文件目录或者上线文件目录的js文件目录",flex:1}]},{xtype:"fieldcontainer",fieldLabel:"skin",layout:"hbox",items:[{xtype:"textfield",value:"skin/",name:"skin",hideLabel:!0,width:228,allowBlank:!1},{xtype:"splitter"},{xtype:"label",text:"相对于源文件目录或者上线文件目录的css及图片文件目录",flex:1}]},{xtype:"fieldcontainer",fieldLabel:"zone",layout:"hbox",items:[{xtype:"textfield",value:"zone/",name:"zone",
hideLabel:!0,width:228,allowBlank:!1},{xtype:"splitter"},{xtype:"label",text:"相对于源文件目录的专区文件目录",flex:1}]},{xtype:"fieldcontainer",fieldLabel:"author",layout:"hbox",items:[{xtype:"textfield",value:"mzhou",name:"author",hideLabel:!0,width:228,allowBlank:!1},{xtype:"splitter"},{xtype:"label",text:"当前开发者代号",flex:1}]},{xtype:"fieldcontainer",fieldLabel:"versionInfo",layout:"hbox",items:[{xtype:"textfield",value:"/* author: {author}, date: {date} */",name:"versionInfo",hideLabel:!0,width:228,allowBlank:!1},
{xtype:"splitter"},{xtype:"label",text:"构建完成后会被添加到文件最上部的基本信息",flex:1}]}],buttons:[{text:"保存",disabled:!0,formBind:!0,width:100,handler:function(){this.up("form").getForm().submit({clientValidation:!0,waitMsg:"保存配置中...",url:"/saveconfig",success:function(b,a){1===a.result.saveStatus?window.location="/":Ext.Msg.alert("错误","错误代码:"+a.result.errorcode)},failure:function(b,a){Ext.Msg.alert("","表单提交失败.");console.log("action.failureType  "+a.failureType);console.log("action.result  "+a.result)}})}},{xtype:"box",
autoEl:{tag:"a",href:"/build",html:"跳转到工作页面"}}]});null!=CONFIG_OBJ&&c(CONFIG_OBJ)});
